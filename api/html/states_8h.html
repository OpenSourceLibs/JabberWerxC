<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>JabberWerxC: states.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">JabberWerxC
   &#160;<span id="projectnumber">2015.1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_849b60ffe128985f6c5d0ef3e5284e22.html">include</a></li><li class="navelem"><a class="el" href="dir_9e648087d18bc011163f1fa270b33ab2.html">jabberwerx</a></li><li class="navelem"><a class="el" href="dir_ada9dcaec615b54a1cb7dcb7ee31db49.html">util</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">states.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions and data structures for the state management engine.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="eventing_8h_source.html">../eventing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mem_8h_source.html">mem.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="workq_8h_source.html">workq.h</a>&quot;</code><br />
</div>
<p><a href="states_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a783246daa7774dce7652f6f17bde3224"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a783246daa7774dce7652f6f17bde3224">JW_STATES_EVENT</a>&#160;&#160;&#160;&quot;stateChanged&quot;</td></tr>
<tr class="separator:a783246daa7774dce7652f6f17bde3224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaa5ce7ce647f96ddf2225e4fac29fce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#acaa5ce7ce647f96ddf2225e4fac29fce">JW_STATES_NAME</a>(num)&#160;&#160;&#160;#num</td></tr>
<tr class="separator:acaa5ce7ce647f96ddf2225e4fac29fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a48b0bf28c1715cc6e9f792c15b91cdef"><td class="memItemLeft" align="right" valign="top">typedef uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a></td></tr>
<tr class="separator:a48b0bf28c1715cc6e9f792c15b91cdef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6456d73979ff92b0d66b3898e9957266"><td class="memItemLeft" align="right" valign="top">typedef struct _jw_states&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a></td></tr>
<tr class="separator:a6456d73979ff92b0d66b3898e9957266"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cd5b07cd1afb1bbc1883634b37901ab"><td class="memItemLeft" align="right" valign="top">typedef struct _jw_states_event_data&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a2cd5b07cd1afb1bbc1883634b37901ab">jw_states_event_data</a></td></tr>
<tr class="separator:a2cd5b07cd1afb1bbc1883634b37901ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acf21ef580160d558ca91600c1056b87c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#acf21ef580160d558ca91600c1056b87c">jw_states_create</a> (const char **names, <a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a> initial, <a class="el" href="workq_8h.html#ae9b96f85721e7a87aa744ab6a2577967">jw_workq</a> *workq, <a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> **states, <a class="el" href="structjw__err.html">jw_err</a> *err)</td></tr>
<tr class="separator:acf21ef580160d558ca91600c1056b87c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac546aef12d1b8f5f09cd01b3717ae692"><td class="memItemLeft" align="right" valign="top"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#ac546aef12d1b8f5f09cd01b3717ae692">jw_states_destroy</a> (<a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> *states)</td></tr>
<tr class="separator:ac546aef12d1b8f5f09cd01b3717ae692"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a107921b77b71cee3d05b851fbc1877e6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> <a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a107921b77b71cee3d05b851fbc1877e6">jw_states_get_current</a> (<a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> *states)</td></tr>
<tr class="separator:a107921b77b71cee3d05b851fbc1877e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7463a0cba562f36bfa002fd01e5b98e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a7463a0cba562f36bfa002fd01e5b98e3">jw_states_get_name_for</a> (<a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> *states, <a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a> state_val)</td></tr>
<tr class="separator:a7463a0cba562f36bfa002fd01e5b98e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fcec357cf720c4de52d1aa54232e6d1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a1fcec357cf720c4de52d1aa54232e6d1">jw_states_register_for</a> (<a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> *states, <a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a> current, <a class="el" href="eventing_8h.html#a54983c8c487b73d33efba11c7b52e827">jw_event</a> *evt, <a class="el" href="eventing_8h.html#a8edac12be7498683eb83794559b27246">jw_event_notify_callback</a> cb, void *arg, <a class="el" href="structjw__err.html">jw_err</a> *err)</td></tr>
<tr class="separator:a1fcec357cf720c4de52d1aa54232e6d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a671318dad0660470478e64e6dfb63550"><td class="memItemLeft" align="right" valign="top"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a671318dad0660470478e64e6dfb63550">jw_states_change</a> (<a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> *states, <a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a> next, void *extra, <a class="el" href="mem_8h.html#a399e3fa217f8ba88d165e055c9cd54df">jw_data_free_func</a> extra_cleaner, <a class="el" href="structjw__err.html">jw_err</a> *err)</td></tr>
<tr class="separator:a671318dad0660470478e64e6dfb63550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0a901952d7d6507e000617466c2ff11"><td class="memItemLeft" align="right" valign="top"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> <a class="el" href="eventing_8h.html#a54983c8c487b73d33efba11c7b52e827">jw_event</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#aa0a901952d7d6507e000617466c2ff11">jw_states_event</a> (<a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> *states, const char *name)</td></tr>
<tr class="separator:aa0a901952d7d6507e000617466c2ff11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f406419cde2fe48bfea246617f40104"><td class="memItemLeft" align="right" valign="top"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> <a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a6f406419cde2fe48bfea246617f40104">jw_states_event_data_get_prev</a> (<a class="el" href="states_8h.html#a2cd5b07cd1afb1bbc1883634b37901ab">jw_states_event_data</a> *event_data)</td></tr>
<tr class="separator:a6f406419cde2fe48bfea246617f40104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc5b971f650e996d6057f502a5a58511"><td class="memItemLeft" align="right" valign="top"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> <a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#afc5b971f650e996d6057f502a5a58511">jw_states_event_data_get_next</a> (<a class="el" href="states_8h.html#a2cd5b07cd1afb1bbc1883634b37901ab">jw_states_event_data</a> *event_data)</td></tr>
<tr class="separator:afc5b971f650e996d6057f502a5a58511"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a658fbf425c6688f3eb6e02d10f88faaa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="states_8h.html#a658fbf425c6688f3eb6e02d10f88faaa">jw_states_event_data_get_extra</a> (<a class="el" href="states_8h.html#a2cd5b07cd1afb1bbc1883634b37901ab">jw_states_event_data</a> *event_data)</td></tr>
<tr class="separator:a658fbf425c6688f3eb6e02d10f88faaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions and data structures for the state management engine. </p>
<p>A states object manages the callbacks bound to specified events to ensure only the specified callbacks are bound when this states object is in a particular state. For the purposes of this object, states are integers between the values of 0 and the length of the "names" array parameter passed into the constructor (max 255 states).</p>
<p>The current implementation is not optimized for large numbers of registered callbacks, but could be made so if the need arises.</p>
<p>Copyrights</p>
<p>Portions created or assigned to Cisco Systems, Inc. are Copyright (c) 2010-2015 Cisco Systems, Inc. All Rights Reserved. See LICENSE for details. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a783246daa7774dce7652f6f17bde3224"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define JW_STATES_EVENT&#160;&#160;&#160;&quot;stateChanged&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>the "stateChanged" event, as documented in <a href="../../events.rst">Events</a> </p>

</div>
</div>
<a class="anchor" id="acaa5ce7ce647f96ddf2225e4fac29fce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define JW_STATES_NAME</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">num</td><td>)</td>
          <td>&#160;&#160;&#160;#num</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>helper macro for stringifying state enum symbols, for use, for example, in populating the 'names' parameter for the constructor </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a48b0bf28c1715cc6e9f792c15b91cdef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint8_t <a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>typedef for an index in the list of states </p>

</div>
</div>
<a class="anchor" id="a6456d73979ff92b0d66b3898e9957266"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct _jw_states <a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>an instance of a states object </p>

</div>
</div>
<a class="anchor" id="a2cd5b07cd1afb1bbc1883634b37901ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct _jw_states_event_data <a class="el" href="states_8h.html#a2cd5b07cd1afb1bbc1883634b37901ab">jw_states_event_data</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>an instance of the object referenced by the data member of the jw_event_data argument sent to the stateChanged event callback(s) </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a671318dad0660470478e64e6dfb63550"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> bool jw_states_change </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> *&#160;</td>
          <td class="paramname"><em>states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a>&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>extra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mem_8h.html#a399e3fa217f8ba88d165e055c9cd54df">jw_data_free_func</a>&#160;</td>
          <td class="paramname"><em>extra_cleaner</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjw__err.html">jw_err</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Changes the current state value for this states object to next.</p>
<p>If the current state before this function is called is the same as next, no operations are performed. Otherwise, this function unbinds the callbacks registered for the current state, binds all of the callbacks registered for next, then triggers the "stateChanged" event.</p>
<p>This function can generate the following errors (set when returning false): </p><ul>
<li><code>JW_ERR_INVALID_ARG</code> if current does not specify a known state </li>
<li><code>JW_ERR_NO_MEMORY</code> if there is insufficient memory to complete the operation</li>
</ul>
<dl class="section invariant"><dt>Invariant</dt><dd>states != NULL </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">states</td><td>the states object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">next</td><td>the target state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">extra</td><td>the opaque pointer to include in the stateChanged event data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">extra_cleaner</td><td>the cleaner function for the extra parameter </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>the error information (provide NULL to ignore) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>true if the state was changed successfully </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acf21ef580160d558ca91600c1056b87c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> bool jw_states_create </td>
          <td>(</td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a>&#160;</td>
          <td class="paramname"><em>initial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="workq_8h.html#ae9b96f85721e7a87aa744ab6a2577967">jw_workq</a> *&#160;</td>
          <td class="paramname"><em>workq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> **&#160;</td>
          <td class="paramname"><em>states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjw__err.html">jw_err</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a states object.</p>
<p>The length of the names array determines the number of states that this object will manage. The state numbers correspond to the indices of their names/descriptions in the names array. The names themselves can be retrieved later via the <a class="el" href="states_8h.html#a7463a0cba562f36bfa002fd01e5b98e3">jw_states_get_name_for()</a> function. The names are not required to be unique, although it is often convenient to make them so.</p>
<p>This function can generate the following errors (set when returning false): </p><ul>
<li><code>JW_ERR_INVALID_ARG</code> if initial does not indicate a valid index in names or if names has too many elements to be represented by the jw_state_val type </li>
<li><code>JW_ERR_NO_MEMORY</code> if there is insufficient memory to initialize the states object</li>
</ul>
<dl class="section invariant"><dt>Invariant</dt><dd>names != NULL </dd>
<dd>
workq != NULL </dd>
<dd>
states != NULL </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">initial</td><td>the initial state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">names</td><td>a NULL-terminated array of strings. Each name in names is duplicated into the new states object; the caller can release the memory for names once this function returns. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">workq</td><td>the workq to use for triggering events asynchronously </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">states</td><td>the newly created states object </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>the error information (provide NULL to ignore) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>true if the states object was created successfully </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac546aef12d1b8f5f09cd01b3717ae692"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> void jw_states_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> *&#160;</td>
          <td class="paramname"><em>states</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unbinds all bound events and destroys the states object.</p>
<p>Note that no events or opaque pointers (such as those passed in as "arg" or "extra" parameters) that have been passed into the object are destroyed.</p>
<dl class="section invariant"><dt>Invariant</dt><dd>states != NULL </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">states</td><td>the states object to destroy </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa0a901952d7d6507e000617466c2ff11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> <a class="el" href="eventing_8h.html#a54983c8c487b73d33efba11c7b52e827">jw_event</a>* jw_states_event </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> *&#160;</td>
          <td class="paramname"><em>states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the event that is triggered whenever a state transition occurs.</p>
<p>The memory allocated for the returned event is owned by the states object.</p>
<dl class="section invariant"><dt>Invariant</dt><dd>states != NULL </dd>
<dd>
name != NULL </dd>
<dd>
*name != '\0' </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">states</td><td>the states object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>The name of the event. For this module, the only valid event name is JW_STATES_EVENT ("stateChanged"). </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">jw_event</td><td>rhe found event or NULL if it does not exist </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a658fbf425c6688f3eb6e02d10f88faaa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> void* jw_states_event_data_get_extra </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="states_8h.html#a2cd5b07cd1afb1bbc1883634b37901ab">jw_states_event_data</a> *&#160;</td>
          <td class="paramname"><em>event_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves the user-supplied extra data during a stateChanged event.</p>
<dl class="section invariant"><dt>Invariant</dt><dd>event_data != NULL </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event_data</td><td>the states event data </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">void*</td><td>the extra data passed to the <a class="el" href="states_8h.html#a671318dad0660470478e64e6dfb63550">jw_states_change()</a> function </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="afc5b971f650e996d6057f502a5a58511"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> <a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a> jw_states_event_data_get_next </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="states_8h.html#a2cd5b07cd1afb1bbc1883634b37901ab">jw_states_event_data</a> *&#160;</td>
          <td class="paramname"><em>event_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves the next state during a stateChanged event.</p>
<dl class="section invariant"><dt>Invariant</dt><dd>event_data != NULL </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event_data</td><td>the states event data </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">jw_state_val</td><td>the next state </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6f406419cde2fe48bfea246617f40104"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> <a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a> jw_states_event_data_get_prev </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="states_8h.html#a2cd5b07cd1afb1bbc1883634b37901ab">jw_states_event_data</a> *&#160;</td>
          <td class="paramname"><em>event_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves the previous state during a stateChanged event.</p>
<dl class="section invariant"><dt>Invariant</dt><dd>event_data != NULL </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event_data</td><td>the states event data </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">jw_state_val</td><td>the previous state </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a107921b77b71cee3d05b851fbc1877e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> <a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a> jw_states_get_current </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> *&#160;</td>
          <td class="paramname"><em>states</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves the current state.</p>
<p><b>NOTE:</b> This method should not be called from a state transition event callback since its value may be misleading if multiple state transitions were initiated in quick succession. The <a class="el" href="states_8h.html#a6f406419cde2fe48bfea246617f40104">jw_states_event_data_get_prev()</a> and _get_next() functions are provided for determining what the current and next states were at the time of the transition.</p>
<dl class="section invariant"><dt>Invariant</dt><dd>states != NULL </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">states</td><td>the states object </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">jw_state_val</td><td>the current state </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7463a0cba562f36bfa002fd01e5b98e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> const char* jw_states_get_name_for </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> *&#160;</td>
          <td class="paramname"><em>states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a>&#160;</td>
          <td class="paramname"><em>state_val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves the name for the given state.</p>
<p>The returned string is owned by the states object and must not be freed by the caller.</p>
<dl class="section invariant"><dt>Invariant</dt><dd>states != NULL </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">states</td><td>the states object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">state_val</td><td>the target state </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">const</td><td>char * the state name/description that was passed to the constructor or NULL if the state is unknown </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1fcec357cf720c4de52d1aa54232e6d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="basics_8h.html#a83a72fcd21631ca7baf97aaaa2778200">JABBERWERX_API</a> bool jw_states_register_for </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="states_8h.html#a6456d73979ff92b0d66b3898e9957266">jw_states</a> *&#160;</td>
          <td class="paramname"><em>states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="states_8h.html#a48b0bf28c1715cc6e9f792c15b91cdef">jw_state_val</a>&#160;</td>
          <td class="paramname"><em>current</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eventing_8h.html#a54983c8c487b73d33efba11c7b52e827">jw_event</a> *&#160;</td>
          <td class="paramname"><em>evt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eventing_8h.html#a8edac12be7498683eb83794559b27246">jw_event_notify_callback</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structjw__err.html">jw_err</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Registers a callback to be bound to an event while this object is in a specific state.</p>
<p>When this states object transitions from another state to current, it will call jw_event_bind(evt, cb, arg, err) for the specified arguments. When it transitions from current to another state, it will call jw_event_unbind(evt, cb). Note that, depending on which events are shared among states, the final order in which the callbacks are called for a specific event may change during a state transition.</p>
<p>If the states object is already in the specified state, the callback is bound to its event immediately.</p>
<p>NOTE: no attempt is made to ensure that the evt/cb combination is unique in the registration list. If duplicates are registered, the most-recently registered evt/cb combination will "win". Any previous entries will just take up memory and CPU time.</p>
<p>This function can generate the following errors (set when returning false): </p><ul>
<li><code>JW_ERR_INVALID_ARG</code> if current does not specify a known state </li>
<li><code>JW_ERR_NO_MEMORY</code> if there is insufficient memory to complete the operation</li>
</ul>
<dl class="section invariant"><dt>Invariant</dt><dd>states != NULL </dd>
<dd>
evt != NULL </dd>
<dd>
cb != NULL </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">states</td><td>the states object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">current</td><td>the target state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">evt</td><td>the target event </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cb</td><td>the callback to bind to the event </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arg</td><td>the opaque argument to pass to the callback </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>the error information (provide NULL to ignore) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>true if the callback was registered successfully </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jul 8 2015 12:17:54 for JabberWerxC by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
